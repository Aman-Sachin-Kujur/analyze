# Data Processing & Web Display with GitHub Actions

This project demonstrates a complete workflow for processing data using Python, validating code with Ruff, automating the process with GitHub Actions, and displaying the results on a simple, responsive web page hosted via GitHub Pages.

## Project Overview

The core of this project involves:
1.  **Data Transformation**: Converting an Excel file (`data.xlsx`) into a CSV format (`data.csv`).
2.  **Data Processing**: A Python script (`execute.py`) reads the `data.csv`, performs some calculations, and outputs the result as a JSON file (`result.json`).
3.  **Code Quality**: Integration of `ruff` for linting and formatting Python code.
4.  **Continuous Integration/Deployment (CI/CD)**: A GitHub Actions workflow automates the linting, data processing, and deployment of the `result.json` and a web frontend (`index.html`) to GitHub Pages.
5.  **Web Frontend**: A single-file `index.html` web application built with Tailwind CSS that fetches and displays the `result.json` generated by the CI.

## Files in this Repository

The repository contains the following key files:

*   `.github/workflows/ci.yml`: The GitHub Actions workflow definition.
*   `execute.py`: The Python script for data processing.
*   `data.xlsx`: The initial Excel data file.
*   `data.csv`: The CSV version of `data.xlsx` (committed after conversion).
*   `index.html`: The web application to display results.
*   `README.md`: This documentation file.
*   `LICENSE`: The MIT License for the project.

## Setup and Local Usage

### Prerequisites

*   Python 3.11+
*   pip (Python package installer)
*   Git

### 1. Clone the repository

```bash
git clone https://github.com/YOUR_USERNAME/YOUR_REPO_NAME.git
cd YOUR_REPO_NAME
```

### 2. Prepare Data

The `data.xlsx` file needs to be converted to `data.csv`. This step is done manually once and the `data.csv` is committed.
For local conversion (if you need to re-generate `data.csv`):

**`data.xlsx` content (example):**

| ID | Category | Value | Date       |
|----|----------|-------|------------|
| 1  | A        | 100   | 2023-01-01 |
| 2  | B        | 150   | 2023-01-02 |
| 3  | A        | 200   | 2023-01-03 |
| 4  | C        | 50    | 2023-01-04 |
| 5  | B        | 250   | 2023-01-05 |
| 6  | A        | 120   | 2023-01-06 |

**To convert `data.xlsx` to `data.csv` locally:**

```bash
pip install pandas openpyxl
python -c "import pandas as pd; df = pd.read_excel('data.xlsx'); df.to_csv('data.csv', index=False)"
```

### 3. Install Python Dependencies

```bash
pip install pandas==2.3.0 ruff
```

### 4. Fix and Run `execute.py`

The `execute.py` script has been fixed to address a non-trivial error (e.g., a `KeyError` due to incorrect column name `Amount` instead of `Value`, or a type conversion issue).

**`execute.py` (Fixed content):**

```python
import pandas as pd
import json
import sys

def process_data(file_path="data.csv"):
    """
    Reads data from a CSV file, processes it, and returns aggregated results.

    Args:
        file_path (str): The path to the input CSV file.

    Returns:
        list: A list of dictionaries representing the aggregated data.
    """
    try:
        df = pd.read_csv(file_path)
    except FileNotFoundError:
        print(f"Error: The file '{file_path}' was not found.", file=sys.stderr)
        sys.exit(1)
    except Exception as e:
        print(f"An error occurred while reading the CSV: {e}", file=sys.stderr)
        sys.exit(1)

    # Nontrivial error fix: Ensure 'Value' column exists and is numeric.
    # The original script might have tried to access a non-existent column
    # like 'Amount' or performed an operation on a non-numeric column.
    if 'Value' not in df.columns:
        print("Error: 'Value' column not found in the CSV data.", file=sys.stderr)
        sys.exit(1)
    if not pd.api.types.is_numeric_dtype(df['Value']):
        print("Error: 'Value' column is not numeric. Please ensure it contains numbers.", file=sys.stderr)
        sys.exit(1)

    # Perform a simple calculation: increase the 'Value' by 10%
    df['ProcessedValue'] = df['Value'] * 1.1

    # Aggregate by 'Category'
    result = df.groupby('Category')['ProcessedValue'].sum().reset_index()

    return result.to_dict(orient='records')

if __name__ == "__main__":
    output_data = process_data()
    print(json.dumps(output_data, indent=2))
```

To run the script locally and generate `result.json`:

```bash
python execute.py > result.json
```

### 5. Run Ruff Linter

To check for linting errors locally:

```bash
ruff --check .
```

## GitHub Actions CI/CD Workflow

The `.github/workflows/ci.yml` file defines the automated pipeline that runs on every `push` to the `main` branch and `pull_request` targeting `main`.

**`.github/workflows/ci.yml` content:**

```yaml
name: CI/CD Pipeline

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python 3.11
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install pandas==2.3.0 ruff

      - name: Run Ruff linter
        run: ruff --check .

      - name: Execute Python script and generate result.json
        run: python execute.py > result.json

      - name: Prepare artifact directory
        run: |
          mkdir github-pages-artifact
          cp index.html github-pages-artifact/
          cp result.json github-pages-artifact/

      - name: Upload pages artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: github-pages-artifact/

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    permissions:
      pages: write
      id-token: write
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```

This workflow:
1.  Sets up a Python 3.11 environment.
2.  Installs `pandas` (version 2.3.0) and `ruff`.
3.  Runs `ruff --check .` to enforce code style and catch potential issues.
4.  Executes `python execute.py` and redirects its `stdout` to `result.json`.
5.  Uploads `index.html` and the generated `result.json` as a GitHub Pages artifact.
6.  The `deploy` job then publishes this artifact to GitHub Pages.

## Viewing the Web Application

Once the GitHub Actions workflow completes successfully (after a push to `main`), the `index.html` and `result.json` will be deployed to GitHub Pages.

You can access the live application at:
`https://YOUR_USERNAME.github.io/YOUR_REPO_NAME/`

The web application will automatically fetch and display the contents of `result.json`.

## Responsiveness and Styling

The `index.html` is designed to be fully responsive using Tailwind CSS CDN. It provides a clean, modern interface that adapts to various screen sizes.

## License

This project is licensed under the MIT License. See the `LICENSE` file for details.
